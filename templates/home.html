<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>CodNotify - Home</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        .usuario-logado {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 14px;
            color: #444;
        }
    </style>
</head>
<body>
    {# Verifica se o usuário está autenticado usando current_user.is_authenticated #}
    {% if current_user.is_authenticated %}
    <div class="usuario-logado">
        {# Acessa o nome do usuário diretamente de current_user #}
        Olá {{ current_user.nome }} se precisar de ajuda, não hesite em
        <a href="/suporte">clicar aqui</a>
        <p style="font-size: 13px; text-align: right; margin-right: 20px;">
        <a href="{{ url_for('logout') }}" style="color: red;">Sair da conta</a> {# Usa url_for para o logout #}
        </p>
    </div>
    {% endif %}

    <!-- {# Adiciona o bloco para exibir mensagens flash #}
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul class=flashes>
        {% for category, message in messages %}
          <li class="{{ category }}">{{ message }}</li>
        {% endfor %}
        </ul>
      {% endif %}
    {% endwith %} -->

    <h1>Notify</h1>
    <p style="margin-top: 10px;">
        <a href="{{ url_for('cadastrar') }}"> {# Usa url_for para o cadastrar #}
            <button style="padding: 10px 20px; font-size: 14px;">+ Cadastrar novo lembrete</button>
        </a>
    </p>

    <p>Este será seu painel de controle para gerenciar as licenças.</p>

    <div class="quadro">
        <h2>Licenças a vencer</h2>
        {% if a_vencer %}
            <ul>
            {% for id_, nome, data in a_vencer %}
                <li>{{ nome }} - vence em {{ data.strftime('%d/%m/%Y') }}
                    - <a href="{{ url_for('editar', id=id_) }}">Editar</a> {# Usa url_for para o editar #}
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>Nenhuma licença a vencer.</p>
        {% endif %}
    </div>

    <div class="quadro">
        <h2>Licenças vencidas</h2>
        {% if vencidas %}
            <ul>
            {% for id_, nome, data in vencidas %}
                <li>{{ nome }} - venceu em {{ data.strftime('%d/%m/%Y') }}
                    - <a href="{{ url_for('editar', id=id_) }}">Editar</a> {# Usa url_for para o editar #}
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>Nenhuma licença vencida.</p>
        {% endif %}
    </div>

    <footer style="text-align: center; margin-top: 50px;">
        <p style="font-size: 15px; color: #686868;">
            SkyNotify 2025 – Desenvolvido por SkyNet Business Intelligence ® <br> Todos os direitos reservados.
        </p>
    </footer>
</body>
</html>